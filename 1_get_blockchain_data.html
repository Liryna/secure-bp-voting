<html>
<head>

    <meta charset="utf-8">

    <!--<script src="https://github.com/EOSIO/eosjs/releases/download/v13.0.0/eos.js"></script>-->
    <!--
        Last bundle which was released on github (13.0.0) generates invalid signatures.
        Version used here was build according to official instructions: https://github.com/EOSIO/eosjs#browser

            git clone https://github.com/EOSIO/eosjs.git
            cd eosjs
            npm install
            npm run build_browser

        If you have any doubts about this eos.js file, replace it with eos.js file build on your own, or
        help convince guys from EOS.IO to release 13.0.1 in form of bundle, with js version ready to use.
    -->
    <script src="eos.js"></script>

    <script>

        function load() {
            let api_endpoint = document.getElementById('api_endpoint').value;

            api_endpoint = api_endpoint.replace(/\/$/, ""); //remove trailing slash

            eos = Eos.Localnet({httpEndpoint: api_endpoint});

            eos.getInfo({}).then(function(result){

                document.getElementById('loaded_info').style.display = 'block';
                document.getElementById('network_info').innerText = JSON.stringify(result, null, "    ");

                eos.getBlock(result.last_irreversible_block_num).then(
                    function(result){
                        document.getElementById('block_num').value = result.block_num;
                        document.getElementById('ref_block_prefix').value = result.ref_block_prefix;
                    }
                )
            });
        }

    </script>
</head>
<body>

    <h1>Load info about the network</h1>

    <form action="javascript:load()">
        <label for="api_endpoint">API Endpoint</label>
        <input type="text" name="api_endpoint" id="api_endpoint" value="" placeholder="http://<adres>:<port>" style="width: 300px;" required>
        <input type="submit" value="Load">
    </form>
    <div id="loaded_info" style="display: none;">
        <pre id="network_info" style="font-size: 0.7em"></pre>
        <p>
            Check if this API Endpoint supports a chain, on which you want to vote, by comparing value of <var>chain_id</var>.
        </p>

        <hr>

        <label for="block_num">block_num</label>
        <input type="text" name="block_num" id="block_num" value=""><br>

        <label for="ref_block_prefix">ref_block_prefix</label>
        <input type="text" name="ref_block_prefix" id="ref_block_prefix" value=""><br>

        <p>Copy or write down <var>block_num</var> and <var>ref_block_prefix</var>. You will need this to generate a valid transaction while being offline.</p>
        <p>Next, go to <a href="2_generate_transaction.html" target="_blank">step 2</a></p>
    </div>

</body>
</html>
